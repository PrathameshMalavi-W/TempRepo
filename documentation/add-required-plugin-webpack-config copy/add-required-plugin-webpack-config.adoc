[#material-new-plugin]
=== Add Angular Material Webpack Plugin

In OneCX v6, applications using Angular Material must add an additional Webpack plugin.
This change is required after upgrading to Angular 19.

[NOTE]
This setup will be replaced by a OneCX-provided Webpack plugin in a future version.

==== Required changes

Extend the application Webpack configuration with the `ModifySourcePlugin`
to rewrite `@angular/material` and `@angular/cdk` source code at build time.

==== Example

[source,javascript]
----
const { ModifySourcePlugin, ReplaceOperation } = require('modify-source-webpack-plugin')

const modifyMaterialPlugin = new ModifySourcePlugin({
  rules: [
    {
      test: (module) => {
        return (
          module.resource &&
          (module.resource.includes('@angular/material') ||
            module.resource.includes('@angular/cdk'))
        )
      },
      operations: [
        new ReplaceOperation(
          'all',
          'document\\.createElement\\(',
          'document.createElementFromMaterial({"this": this, "arguments": Array.from(arguments)},'
        )
      ]
    }
  ]
})

module.exports = {
  ...webpackConfig,
  plugins: [...plugins, modifyMaterialPlugin]
}
----